(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[19],{206:function(e,t,a){},264:function(e,t,a){"use strict";a.r(t);var n=a(24),i=a(3),s=a(4),r=a(11),o=a(10),l=a(12),c=a(0),h=a.n(c),u=a(2),m=a.n(u),d=a(36),p=a.n(d),f=a(124),g=a.n(f),v=a(60),y=(a(61),a(37)),b=a(28),E=(a(206),0),_=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).state={value:"",items:[],item:a.props.item||{},search:"",inputAddonClass:"fa fa-search"},a.keys={UP:38,DOWN:40,ENTER:13,ESC:27,PLUS:43,A:65,Z:90,SPACE:32,TAB:9},a.nameList=h.a.createRef(),a.input=h.a.createRef(),a.hiddenInput=h.a.createRef(),a.nameDropdown=h.a.createRef(),a.timeout=null,a.handleChange=function(e){var t=e.target.value;a.setState({search:e.target.value},(function(){return a._itemSelect(null)})),clearTimeout(a.timeout),a.timeout=setTimeout((function(){a.fetchData(t)}),500)},a.handleFocus=function(){a._showDropdown()},a.handleBlur=function(e){},a.ns=".NameSearchInput-"+E++,a.handleListItemClick=a.handleListItemClick.bind(Object(y.a)(a)),a.handleMouseOver=a.handleMouseOver.bind(Object(y.a)(a)),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.disabled||(this.props.value?this.fetchItemData(this.props.value).then((function(t){return e._setItem(t.data)})):this.fetchData())}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.props.disabled||(this.props.item&&!p.a.isEqual(this.props.item!==e.item)&&this._setItem(this.props.item),this.props.value!==this.state.value&&(this.setState({value:this.props.value}),this.fetchItemData(this.props.value).then((function(e){return a._setItem(e.data)}))))}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.setState({inputAddonClass:"fa fa-circle-o-notch fa-spin fa-fw"}),this.props.fetchItems(t).then((function(t){e.setState({items:t.data})}),(function(e){return console.log(e.response.data)})).finally((function(t){return e.setState({inputAddonClass:"fa fa-search"})}))}},{key:"fetchItemData",value:function(e){var t=this;return this.setState({inputAddonClass:"fa fa-circle-o-notch fa-spin fa-fw"}),this.props.itemDetails(e).finally((function(e){return t.setState({inputAddonClass:"fa fa-search"})}))}},{key:"displayItem",value:function(e){return this.props.displayItem?this.props.displayItem(e):e}},{key:"handleKeyDown",value:function(e){if(this.nameDropdown.current.classList.contains("d-none"))return this._showDropdown(),void e.preventDefault();e.which===this.keys.UP||e.which===this.keys.DOWN?this._handleUpDownKey(e.which):e.which===this.keys.ENTER?this._handleEnterKey(e):e.which===this.keys.ESC&&this._closeDropdown()}},{key:"_handleUpDownKey",value:function(e){var t,a=b(this.nameList.current).children(".highlight").first();(t=a.length?e===this.keys.UP?a.prev():a.next():b(this.nameList.current).children(":first")).length&&(this._highlightListItem(t),this._scrollTo(t))}},{key:"_handleEnterKey",value:function(e){e.preventDefault();var t=b(this.nameList.current).children(".highlight").first();t.length||(t=b(this.nameList.current).children().first()),t.length&&(this._selectListItem(t),this._closeDropdown())}},{key:"_scrollTo",value:function(e,t){e=b(e);var a=b(this.nameList.current),n=a.height(),i=a.offset().top,s=i+n,r=e.outerHeight(),o=e.offset().top,l=o+r,c=o-i+a.scrollTop(),h=n/2-r/2;if(o<i)t&&(c-=h),a.scrollTop(c);else if(l>s){t&&(c+=h);var u=n-r;a.scrollTop(c-u)}}},{key:"handleMouseOver",value:function(e){e.target.classList.contains("name-item")&&this._highlightListItem(e.target)}},{key:"handleListItemClick",value:function(e){var t=b(this.nameList.current).children(".highlight").first();t.length&&(this._selectListItem(t),this._closeDropdown())}},{key:"_highlightListItem",value:function(e){b(this.nameList.current.children).removeClass("highlight"),b(e).addClass("highlight")}},{key:"_selectListItem",value:function(e){var t=b(e).attr("data-user-id"),a=this.state.items.find((function(e){return e.id==t}));this._itemSelect(a)}},{key:"_itemSelect",value:function(e){if(e){this._setItem(e);var t=this.props.data?e[this.props.data]:e;this._setInputValue(t)}else this._setInputValue("");this.props.userSelected&&this.props.userSelected(e)}},{key:"_setInputValue",value:function(e){this.setState({value:e}),Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set.call(this.hiddenInput.current,e);var t=new Event("input",{bubbles:!0});this.hiddenInput.current.dispatchEvent(t)}},{key:"_setItem",value:function(e){var t=this.displayItem(e);this.setState({search:t,item:e})}},{key:"_showDropdown",value:function(){var e=this;this.nameDropdown.current.style.width="".concat(this.input.current.offsetWidth,"px"),this.nameDropdown.current.classList.remove("d-none");var t=!0;b("html").on("click"+e.ns,(function(a){if(!t){var n=b(e.nameDropdown.current),i=n.offset(),s=i.left+n.width(),r=i.top+n.height();a.clientX>=i.left&&a.clientX<=s&&a.clientY>=i.top&&a.clientY<=r||e._closeDropdown()}t=!1}))}},{key:"_closeDropdown",value:function(){this.nameDropdown.current.classList.add("d-none"),b("html").off(this.ns)}},{key:"render",value:function(){var e,t=this;return h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:"input-group"},h.a.createElement("input",(e={type:"text",ref:this.input,onKeyDown:this.handleKeyDown.bind(this),className:"form-control ".concat(this.props.className),placeholder:this.props.placeholder,onChange:this.handleChange,onFocus:this.handleFocus,onBlur:this.handleBlur,value:this.state.search},Object(n.a)(e,"type","text"),Object(n.a)(e,"className","form-control ".concat(this.props.className)),Object(n.a)(e,"autoComplete","off"),Object(n.a)(e,"aria-label",this.props.placeholder),Object(n.a)(e,"aria-describedby","basic-addon2"),Object(n.a)(e,"name",this.props.name),Object(n.a)(e,"disabled",this.props.disabled),e)),h.a.createElement("div",{className:"input-group-append"},h.a.createElement("span",{className:"input-group-text",id:"basic-addon2"},h.a.createElement("i",{className:this.state.inputAddonClass})))),h.a.createElement("div",{ref:this.nameDropdown,className:"names-dropdown-container d-none"},h.a.createElement("ul",{ref:this.nameList,className:"name-list",onMouseOver:this.handleMouseOver,onClick:this.handleListItemClick},this.state.items.map((function(e){return h.a.createElement("li",{key:e.id,className:"name-item","data-user-id":e.id},h.a.createElement("span",{className:"name"},t.displayItem(e)))})))),h.a.createElement("input",{onChange:this.props.onChange,name:this.props.name,style:{display:"none"},ref:this.hiddenInput,value:this.state.value}))}}]),t}(c.Component);a.d(t,"default",(function(){return k}));var k=function(e){function t(){var e,a;Object(i.a)(this,t);for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return(a=Object(r.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(l)))).state={error:{},organization_id:"",admission_no:"",amount:"",phonenumber:"",loading:!1},a.pay=function(){a.setState({loading:!0});var e=a.state,t=e.organization_id,n=e.admission_no,i=e.amount,s=e.phonenumber;m.a.post("/api/pay-fees",{organization_id:t,admission_no:n,amount:i,phonenumber:s}).then((function(e){window.location=e.data.link}),(function(e){a.setState({error:e.response.data.errors}),a.setState({loading:!1})}))},a.inputChanged=function(e){var t=e.target.name,i=e.target.value;"organization_id"==t?a.setState({organization_id:i,admission_no:""}):a.setState(Object(n.a)({},t,e.target.value))},a.displayOrganizationDetail=function(e){return e.name.toUpperCase()+(e.location?" | ".concat(e.location.toUpperCase()," "):"")},a.displayStudentDetail=function(e){return e.admission_no+" | "+e.firstname.toUpperCase()+" "+e.lastname.toUpperCase()},a.getOrganizationList=function(e){return m.a.get("/api/pay-fees/search-organization",{params:{name:e}})},a.getOrganizationDetails=function(e){return m.a.get("/api/pay-fees/organization/".concat(e))},a.getStudentList=function(e){return m.a.get("/api/pay-fees/search-student",{params:{admission_no:e,organization_id:a.state.organization_id}})},a.getStudentDetails=function(e){return m.a.get("/api/pay-fees/student/".concat(a.state.organization_id,"/").concat(e))},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;if("/pay-fees/success"==this.props.location.pathname){var t=this.props.location.search.match(/ref=([^&]+)/)[1];m.a.get("/api/pay-fees/".concat(t)).then((function(t){g.a.fire({icon:"success",title:"Payment Received",text:"".concat(t.data.firstname," ").concat(t.data.lastname," payed ").concat(t.data.amount)}).then((function(){e.props.history.replace("/pay-fees")}))}))}}},{key:"render",value:function(){var e=this.state.error.organization_id?"is-invalid":"",t=this.state.error.admission_no?"is-invalid":"",a=this.state.error.amount?"is-invalid":"",n=this.state.error.phonenumber?"is-invalid":"",i=this.props.match;return h.a.createElement("div",{className:"wrapper wrapper-full-page"},h.a.createElement(v.a,{match:i}),h.a.createElement("div",{className:"full-page register-page section-image","data-color":"orange","data-image":"/theme/img/bg5.jpg"},h.a.createElement("div",{className:"content"},h.a.createElement("div",{className:"container"},h.a.createElement("form",{id:"login-form"},h.a.createElement("div",{className:"col-md-4 col-sm-6 ml-auto mr-auto"},h.a.createElement("div",{className:"card card-login"},h.a.createElement("div",{className:"card-body "},h.a.createElement("div",{className:"card-body"},h.a.createElement("div",{className:"card-header "},h.a.createElement("img",{src:"/img/logo.jpg",style:{display:"block",marginLeft:"auto",marginRight:"auto",width:"50%"}})),h.a.createElement("div",{className:"form-group"},h.a.createElement("label",null,"Organization Name"),h.a.createElement("div",{className:"form-group required"},h.a.createElement(_,{fetchItems:this.getOrganizationList,itemDetails:this.getOrganizationDetails,displayItem:this.displayOrganizationDetail,data:"id",value:this.state.organization_id,onChange:this.inputChanged,name:"organization_id",className:"form-control ".concat(e),placeholder:"Organization Name","aria-required":"true"}),this.state.error.organization_id&&this.state.error.organization_id.map((function(e,t){return h.a.createElement("span",{key:t,className:"invalid-feedback",role:"alert"},h.a.createElement("strong",null,e))})),h.a.createElement("p",{className:"help-block help-block-error"}))),h.a.createElement("div",{className:"form-group"},h.a.createElement("label",null,"Admission Number"),h.a.createElement("div",{className:"form-group required"},h.a.createElement(_,{disabled:!this.state.organization_id,fetchItems:this.getStudentList,itemDetails:this.getStudentDetails,displayItem:this.displayStudentDetail,data:"admission_no",value:this.state.admission_no,onChange:this.inputChanged,name:"admission_no",className:"form-control ".concat(t),placeholder:"Admission Number","aria-required":"true"}),this.state.error.admission_no&&this.state.error.admission_no.map((function(e,t){return h.a.createElement("span",{key:t,className:"invalid-feedback",role:"alert"},h.a.createElement("strong",null,e))})),h.a.createElement("p",{className:"help-block help-block-error"}))),h.a.createElement("div",{className:"form-group"},h.a.createElement("label",null,"Amount"),h.a.createElement("div",{className:"form-group required"},h.a.createElement("input",{value:this.state.amount,onChange:this.inputChanged,name:"amount",type:"text",className:"form-control ".concat(a),placeholder:"Amount",autoComplete:"off","aria-required":"true"}),this.state.error.amount&&this.state.error.amount.map((function(e,t){return h.a.createElement("span",{key:t,className:"invalid-feedback",role:"alert"},h.a.createElement("strong",null,e))})),h.a.createElement("p",{className:"help-block help-block-error"}))),h.a.createElement("div",{className:"form-group"},h.a.createElement("label",null,"Phone Number"),h.a.createElement("div",{className:"form-group required"},h.a.createElement("input",{value:this.state.phonenumber,onChange:this.inputChanged,name:"phonenumber",type:"text",className:"form-control ".concat(n),placeholder:"Phone Number",autoComplete:"off","aria-required":"true"}),this.state.error.phonenumber&&this.state.error.phonenumber.map((function(e,t){return h.a.createElement("span",{key:t,className:"invalid-feedback",role:"alert"},h.a.createElement("strong",null,e))})),h.a.createElement("p",{className:"help-block help-block-error"}))))),h.a.createElement("div",{className:"card-footer ml-auto mr-auto"},h.a.createElement("button",{disabled:this.state.loading,onClick:this.pay,type:"button",className:"btn btn-warning btn-wd",name:"signup-button"},"Pay")))))))))}}]),t}(c.Component)}}]);
//# sourceMappingURL=19.c1aaf228.chunk.js.map