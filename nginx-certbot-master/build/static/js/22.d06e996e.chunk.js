(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[22],{118:function(e,t,a){"use strict";var n=a(124),r=a.n(n);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.a.fire({title:"Are you sure?",text:t.consequence||"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:t.yes||"Yes"}).then((function(a){if(a.value){var n=r.a.fire({title:t.loading||"Waiting...",text:t.loading_text||"waiting for operation to complete",showConfirmButton:!1,onBeforeOpen:function(){r.a.showLoading()}});e().then((function(e){n.closeModal(),r.a.fire(e.success,e.succes_text,"success")}),(function(e){n.closeModal(),r.a.fire({icon:"error",title:"Oops...",text:e.error,footer:e.footer||""})}))}else a.dismiss===r.a.DismissReason.cancel&&r.a.fire("Cancelled",t.canceled,"error")}))}},262:function(e,t,a){"use strict";a.r(t);var n=a(24),r=a(3),l=a(4),s=a(11),c=a(10),i=a(12),o=a(0),d=a.n(o),u=a(17),m=a(2),b=a.n(m),h=a(38),v=a(39),p=a(118),f=a(190),E=a(189),_=a(146),y=a(247),g=a(236),j=a(267),N=a(268),C=a(245),O=a(239),S=a(252),k=Object(g.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120}}}));function w(e){var t=k(),a=d.a.useState(""),n=Object(f.a)(a,2);n[0],n[1];return d.a.createElement(O.a,{className:t.formControl,error:""!==e.error},d.a.createElement(j.a,{id:"activity-select-label"},"Activity"),d.a.createElement(S.a,{labelId:"activity-select-label",id:"activity-select",value:e.value,onChange:e.onChange,autoWidth:!0},d.a.createElement(N.a,{value:1},"Lesson"),d.a.createElement(N.a,{value:0},"Break")),d.a.createElement(C.a,null,e.error))}var T,x=function(e){function t(){var e,a;Object(r.a)(this,t);for(var l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={activity_add:"",start_add:"08:00",end_add:"08:00",start_add_error:"",end_add_error:"",activity_add_error:"",schedule:[]},a.save=function(){var e=a.state.schedule||[];b.a.post("/api/timetable/setup",{schedule:e}).then((function(e){a.setState({schedule:e.data.schedule})}))},a.add=function(){var e=a.state.schedule.slice(0),t=e[e.length-1],n="",r="",l="";t&&Date.parse("2020-02-02T"+t.end)>Date.parse("2020-02-02T"+a.state.start_add)&&(n="Start should be greater than previous period end"),Date.parse("2020-02-02T"+a.state.start_add)>=Date.parse("2020-02-02T"+a.state.end_add)&&(r="End should be greater than start of the period"),""===a.state.activity_add&&(l="Please set the activity"),""!==n||""!==r||""!==l?a.setState({start_add_error:n,end_add_error:r,activity_add_error:l}):(e.push({activity:a.state.activity_add,start:a.state.start_add,end:a.state.end_add}),a.setState({schedule:e,start_add_error:n,end_add_error:r,activity_add_error:l,start_add:a.state.end_add},a.save))},a.handleDateChangeAdd=function(e,t){if(t){var r=t.toTimeString().split(" ")[0].split(":").slice(0,2).join(":");a.setState(Object(n.a)({},e,r))}},a.activityChange=function(e){a.setState({activity_add:e.target.value})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;b.a.get("/api/timetable/setup").then((function(t){return e.setState({schedule:t.data.schedule||[]})}))}},{key:"delete",value:function(e){var t=this.state.schedule.slice(0);t.splice(e,1),this.setState({schedule:t},this.save)}},{key:"render",value:function(){var e=this,t=0,a=0;return d.a.createElement("div",{className:"container-fluid"},d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-sm-12"},d.a.createElement("div",{className:"card"},d.a.createElement("div",{className:"card-header"},d.a.createElement("nav",{className:"text-center"},d.a.createElement("h5",null,"Daily Schedule"))),d.a.createElement("div",{className:"card-body table-responsive text-center"},d.a.createElement(_.a,{utils:E.a},d.a.createElement("table",{className:"table table-striped"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,"Activity"),d.a.createElement("th",null,"Start"),d.a.createElement("th",null,"End"),d.a.createElement("th",null,"Action"))),d.a.createElement("tbody",null,this.state.schedule.map((function(n,r){return d.a.createElement("tr",{key:r},d.a.createElement("td",null,d.a.createElement("button",{type:"button",className:"btn btn-info"},1==n.activity?"Lesson":"Break"," ",d.a.createElement("span",{className:"badge badge-light"},1==n.activity?++t:++a))),d.a.createElement("td",null,d.a.createElement("button",{type:"button",className:"btn btn-primary"},n.start,d.a.createElement("i",{className:"fa fa-clock-o"}))),d.a.createElement("td",null,d.a.createElement("button",{type:"button",className:"btn btn-success"},n.end,d.a.createElement("i",{className:"fa fa-clock-o"}))),d.a.createElement("td",null,d.a.createElement("button",{onClick:e.delete.bind(e,r),type:"button",className:"btn btn-danger"}," Remove ",d.a.createElement("i",{className:"fa fa-trash"}))))}))),d.a.createElement("tfoot",null,d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement(w,{onChange:this.activityChange,value:this.state.activity_add,error:this.state.activity_add_error})),d.a.createElement("td",null,d.a.createElement(y.a,{margin:"normal",id:"time-picker",label:"Start Time",error:""!==this.state.start_add_error,helperText:this.state.start_add_error,value:"2020-12-30T"+this.state.start_add,onChange:this.handleDateChangeAdd.bind(this,"start_add"),KeyboardButtonProps:{"aria-label":"change time"}})),d.a.createElement("td",null,d.a.createElement(y.a,{margin:"normal",id:"time-picker",label:"End Time",error:""!==this.state.end_add_error,helperText:this.state.end_add_error,value:"2020-12-30T"+this.state.end_add,onChange:this.handleDateChangeAdd.bind(this,"end_add"),KeyboardButtonProps:{"aria-label":"change time"}})),d.a.createElement("td",null,d.a.createElement("button",{onClick:this.add,type:"button",className:"btn btn-success"}," Add ",d.a.createElement("i",{className:"fa fa-plus"}))))))))))))}}]),t}(o.Component),D=a(246),A=Object(g.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120},root:{"& > *":{margin:e.spacing(1),width:200}}}}));function B(e){var t=A();return d.a.createElement(O.a,{className:t.root,error:""!==e.error},d.a.createElement(D.a,{value:e.value,onChange:e.onChange,label:"Lab Name",error:""!==e.error,helperText:e.error}))}function M(e){var t=A(),a=d.a.useState(""),n=Object(f.a)(a,2),r=(n[0],n[1],e.subjects||[]);return d.a.createElement(O.a,{className:t.formControl,error:""!==e.error},d.a.createElement(j.a,{id:"activity-select-label"},"Activity"),d.a.createElement(S.a,{labelId:"activity-select-label",id:"activity-select",value:e.value,onChange:e.onChange,autoWidth:!0},r.map((function(e){return d.a.createElement(N.a,{key:e.id,value:e.id},e.name)}))),d.a.createElement(C.a,null,e.error))}var W,F=Object(h.b)("subjectStore")(T=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={subjects:[],name_add:"",subject_add:"",name_add_error:"",subject_add_error:"",labs:[]},a.save=function(){var e=a.state.labs||[];b.a.post("/api/timetable/setup",{labs:e}).then((function(e){a.setState({labs:e.data.labs})}))},a.add=function(){var e=a.state.labs.slice(0),t="",n="";""===a.state.name_add&&(t="Name required"),""===a.state.subject_add&&(n="Subject required"),""!==t||""!==n?a.setState({name_add_error:t,subject_add_error:n}):(e.push({name:a.state.name_add,subject_id:a.state.subject_add}),a.setState({labs:e,name_add:"",subject_add:"",name_add_error:t,subject_add_error:n},a.save))},a.subjectChange=function(e){a.setState({subject_add:e.target.value})},a.nameChange=function(e){a.setState({name_add:e.target.value})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;b.a.get("/api/timetable/setup").then((function(t){return e.setState({labs:t.data.labs||[]})})),this.props.subjectStore.list({},!0).then((function(t){e.setState({subjects:t})}))}},{key:"delete",value:function(e){var t=this.state.labs.slice(0);t.splice(e,1),this.setState({labs:t},this.save)}},{key:"getSubjectName",value:function(e){var t=this.state.subjects.find((function(t){return t.id==e}));return t?t.name:e}},{key:"render",value:function(){var e=this;return d.a.createElement("div",{className:"container-fluid"},d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-sm-12"},d.a.createElement("div",{className:"card"},d.a.createElement("div",{className:"card-header"},d.a.createElement("nav",{className:"text-center"},d.a.createElement("h5",null,"Labs"))),d.a.createElement("div",{className:"card-body table-responsive text-center"},d.a.createElement(_.a,{utils:E.a},d.a.createElement("table",{className:"table table-striped"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,"Subjct"),d.a.createElement("th",null,"Name"))),d.a.createElement("tbody",null,this.state.labs.map((function(t,a){return d.a.createElement("tr",{key:a},d.a.createElement("td",null,d.a.createElement("button",{type:"button",className:"btn btn-info"}," ",e.getSubjectName(t.subject_id))),d.a.createElement("td",null,d.a.createElement("button",{type:"button",className:"btn btn-primary"},t.name)),d.a.createElement("td",null,d.a.createElement("button",{onClick:e.delete.bind(e,a),type:"button",className:"btn btn-danger"}," Remove ",d.a.createElement("i",{className:"fa fa-trash"}))))}))),d.a.createElement("tfoot",null,d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement(M,{subjects:this.state.subjects,onChange:this.subjectChange,value:this.state.subject_add,error:this.state.subject_add_error})),d.a.createElement("td",null,d.a.createElement(B,{value:this.state.name_add,onChange:this.nameChange,error:this.state.name_add_error})),d.a.createElement("td",null,d.a.createElement("button",{onClick:this.add,type:"button",className:"btn btn-success"}," Add ",d.a.createElement("i",{className:"fa fa-plus"}))))))))))))}}]),t}(o.Component))||T;a.d(t,"default",(function(){return G}));var G=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.match;return d.a.createElement(v.a,null,d.a.createElement(u.b,{path:"".concat(e.path,"/day-schedule"),render:function(e){return d.a.createElement(x,e)}}),d.a.createElement(u.b,{path:"".concat(e.path,"/labs"),render:function(e){return d.a.createElement(F,e)}}),d.a.createElement(u.b,{exact:!0,path:"".concat(e.path),render:function(e){return d.a.createElement(L,e)}}))}}]),t}(o.Component),L=Object(h.b)("classesStore")(W=function(e){function t(){var e,a;Object(r.a)(this,t);for(var l=arguments.length,i=new Array(l),o=0;o<l;o++)i[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={payload:"",streams:[],classes:[]},a.filterChanged=function(e){var t=e.target.name,r=e.target.value;"class_id"==t?a.setState({class_id:r,stream_id:""}):a.setState(Object(n.a)({},t,r))},a.generate=function(){Object(p.a)((function(){return b.a.post("/api/timetable/generate").then((function(e){return a.setState({timetable:e.data}),{success:"Generated!",succes_text:"Timetable was generated"}}),(function(e){throw{error:"Timetable couldn't be generated."}}))}),{loading_title:"Generating...",loading_text:"Generating Timetable",canceled:"Generating Timetable Operation Cancelled",consequence:"Current Timetable will be over-written"})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.classesStore.list({},!0).then((function(t){var a=t.reduce((function(e,t){return e=e.concat(t.streams)}),[]);e.setState({classes:t,streams:a})})),b.a.get("/api/timetable/allocations").then((function(t){e.setState({allocations:t.data})})),b.a.get("/api/timetable").then((function(t){e.setState({timetable:t.data})}))}},{key:"render",value:function(){var e=this,t=(this.state.timetable,this.state.classes),a=null;if(t){var n=t.find((function(t){return t.id==e.state.class_id}));n&&(a=n.streams)}var r=this.state.streams.filter((function(t){var a=!0;return e.state.class_id&&(a=t.class_id==e.state.class_id),e.state.stream_id&&(a=t.id==e.state.stream_id),a}));return d.a.createElement("div",{className:"container-fluid"},d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-md-12"},d.a.createElement("span",{className:"pull-right"},d.a.createElement("button",{onClick:this.generate,type:"button",className:"btn btn-primary"},"Generate")))),d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"card col-12"},d.a.createElement("div",{className:"card-header text-center"},d.a.createElement("h3",null,"Timetable")),d.a.createElement("div",{className:"card-body"},d.a.createElement("div",{className:"row"},d.a.createElement("select",{className:"col-sm-6 form-control",value:this.state.class_id,onChange:this.filterChanged,name:"class_id"},d.a.createElement("option",{value:""}," -- Filter Class -- "),this.state.classes.map((function(e){return d.a.createElement("option",{key:e.id,value:e.id},e.name)}))),d.a.createElement("select",{className:"col-sm-6 form-control",value:this.state.stream_id,onChange:this.filterChanged,name:"stream_id"},d.a.createElement("option",{value:""}," -- Filter Stream -- "),a&&a.map((function(e){return d.a.createElement("option",{key:e.id,value:e.id},e.name)}))))))),r.map((function(t){return d.a.createElement("div",{key:t.id,className:"row"},d.a.createElement("div",{className:"col-12"},d.a.createElement(q,{stream:t,cls:e.state.classes.find((function(e){return e.id==t.class_id})),table:e.state.timetable,allocations:e.state.allocations})))})))}}]),t}(o.Component))||W,q=function(e){function t(){return Object(r.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"allocationDetail",value:function(e){var t=(this.props.allocations||[]).find((function(t){return t.id==e}));return t?d.a.createElement(d.a.Fragment,null,t.subject.name,d.a.createElement("br",null),t.teacher.name):"-"}},{key:"getCellDetails",value:function(e,t){var a=this.props.stream.id;if(!a||!this.props.table||!this.props.table.table)return"-";var n=this.props.table.table[a];if(!n)return"-";var r=n[e+1][t+1];if(this.props.allocations&&r){var l=this.props.allocations.find((function(e){return e.id==r}));return d.a.createElement(d.a.Fragment,null,l.subject.name,d.a.createElement("br",null),l.teacher.name)}return"-"}},{key:"render",value:function(){var e=this,t=this.props.table&&this.props.table.schedule?this.props.table.schedule:[],a=this.props.cls;return d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"card col-12"},d.a.createElement("div",{className:"card-header text-center"},d.a.createElement("h3",null,a&&a.name," ",this.props.stream.name)),d.a.createElement("div",{className:"card-body"},d.a.createElement("table",{className:"table table-striped"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null),t.map((function(e,t){return d.a.createElement("th",{key:t},e.start,"-",e.end)})))),d.a.createElement("tbody",null,["Monday","Tuesday","Wednesday","Thursday","Friday"].map((function(a,n){return d.a.createElement("tr",{key:n},d.a.createElement("th",null,a),t.map((function(t,a){return d.a.createElement("td",{key:a},1==t.activity?e.getCellDetails(n,a):d.a.createElement("span",{className:"badge badge-info"},"Break")," ")})))})))))))}}]),t}(o.Component)}}]);
//# sourceMappingURL=22.d06e996e.chunk.js.map